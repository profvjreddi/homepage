import{j as e}from"./ui-vendor-BSk9rHGn.js";import{f as t,r}from"./react-vendor-Bn7-wGob.js";import{r as a}from"./viz-vendor-D8rmSDxo.js";const s=["about","after","all","also","am","an","and","another","any","are","as","at","be","because","been","before","being","between","both","but","by","came","can","come","could","did","do","each","for","from","get","got","has","had","he","have","her","here","him","himself","his","how","if","in","into","is","it","like","make","many","me","might","more","most","much","must","my","never","now","of","on","only","or","other","our","out","over","said","same","should","since","some","still","such","take","than","that","the","their","them","then","there","these","they","this","those","through","to","too","under","up","very","was","way","we","well","were","what","where","which","while","who","with","would","you","your","a","i"];const o=t(a()),i=({publications:t,width:a=800,height:i=600,className:n="",selectedArea:l,template:c="harvard"})=>{const h=r.useRef(null),[u,m]=r.useState(!1),d={harvard:{color:(e,t,r)=>{const a=t/r;return`hsl(0, ${70+20*a}%, ${60-30*a}%)`},weightFactor:(e,t)=>{const r=e/t;return Math.max(14,Math.min(60,14+46*r))},rotateRatio:.3,shape:"circle"},modern:{color:(e,t,r)=>{const a=t/r;return`hsl(${220+40*a}, ${60+30*a}%, ${50-20*a}%)`},weightFactor:(e,t)=>{const r=e/t;return Math.max(12,Math.min(72,12+60*r))},rotateRatio:.5,shape:"circle"},academic:{color:(e,t,r)=>{const a=t/r;return`hsl(45, ${80+20*a}%, ${55-25*a}%)`},weightFactor:(e,t)=>{const r=e/t;return Math.max(16,Math.min(56,16+40*r))},rotateRatio:.1,shape:"circle"},minimal:{color:(e,t,r)=>`hsl(0, 0%, ${20+60*(t/r)}%)`,weightFactor:(e,t)=>{const r=e/t;return Math.max(10,Math.min(48,10+38*r))},rotateRatio:0,shape:"circle"},rainbow:{color:(e,t,r)=>{const a=t/r;return`hsl(${240-240*a}, ${60+20*a}%, ${45+15*a}%)`},weightFactor:(e,t)=>{const r=e/t;return Math.max(12,Math.min(68,12+56*r))},rotateRatio:.4,shape:"circle"},sunset:{color:(e,t,r)=>{const a=t/r;return`hsl(${0+60*a}, ${85+15*a}%, ${55+15*a}%)`},weightFactor:(e,t)=>{const r=e/t;return Math.max(14,Math.min(64,14+50*r))},rotateRatio:.2,shape:"circle"},ocean:{color:(e,t,r)=>{const a=t/r;return`hsl(${200+40*a}, ${70+30*a}%, ${40+30*a}%)`},weightFactor:(e,t)=>{const r=e/t;return Math.max(13,Math.min(62,13+49*r))},rotateRatio:.3,shape:"circle"},forest:{color:(e,t,r)=>{const a=t/r;return`hsl(${120+40*a}, ${75+25*a}%, ${35+35*a}%)`},weightFactor:(e,t)=>{const r=e/t;return Math.max(15,Math.min(58,15+43*r))},rotateRatio:.25,shape:"circle"}},f=r.useMemo(()=>{if(!t||0===t.length)return[];const e=l&&"All"!==l?t.filter(e=>{var t;return null==(t=e.areas)?void 0:t.includes(l)}):t;if(0===e.length)return[];const r={};e.forEach(e=>{if(!e.title)return;let t=e.title.toLowerCase().split(/\W+/);t=((e,t=s)=>{if(!Array.isArray(e)||!Array.isArray(t))throw new Error("expected Arrays try: removeStopwords(Array[, Array])");return e.filter(e=>!t.includes(e.toLowerCase()))})(t).filter(e=>e.length>=3&&!/^\d+$/.test(e)&&!/^[a-z]$/.test(e)),t.forEach(e=>{r[e]=(r[e]||0)+1})});return Object.entries(r).sort((e,t)=>t[1]-e[1]).slice(0,150).map(([e,t])=>[e,t])},[t,l]);if(r.useEffect(()=>{if(!h.current||0===f.length)return;m(!0);const e=h.current,t=Math.max(...f.map(([e,t])=>t)),r={list:f,gridSize:12,weightFactor:function(e){return d[c].weightFactor(e,t)},fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:function(e,r){return d[c].color(e,r,t)},rotateRatio:d[c].rotateRatio,rotationSteps:2,backgroundColor:"transparent",shape:d[c].shape,ellipticity:.8,classes:"wordcloud",hover:function(e,t,r){r.target.style.cursor="pointer",r.target.style.transform="scale(1.05)",r.target.style.transition="all 0.2s ease"},click:function(e,t,r){r.target.style.transform=""}};e.width=a,e.height=i;const s=e.getContext("2d");s&&s.clearRect(0,0,a,i);try{o(e,r),m(!1)}catch(n){m(!1)}},[f,a,i,c]),!t||0===t.length)return e.jsx("div",{className:`flex items-center justify-center bg-gray-50 rounded-lg ${n}`,style:{width:a,height:i},children:e.jsx("p",{className:"text-gray-500",children:"No publications available for word cloud"})});const g=l&&"All"!==l?t.filter(e=>{var t;return null==(t=e.areas)?void 0:t.includes(l)}):t;return 0===g.length?e.jsx("div",{className:`flex items-center justify-center bg-gray-50 rounded-lg ${n}`,style:{width:a,height:i},children:e.jsx("p",{className:"text-gray-500",children:"No publications in selected area"})}):e.jsxs("div",{className:`${n}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4 text-center",children:l&&"All"!==l?`${l} Keywords`:"Publication Keywords"}),e.jsxs("div",{className:"relative flex justify-center items-center",style:{minHeight:i},children:[u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-90 z-10 rounded-lg",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#A51C30] mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generating word cloud..."})]})}),e.jsx("canvas",{ref:h,width:a,height:i,className:"w-full h-auto",style:{display:"block"}})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4 text-center",children:["Word size indicates frequency in publication titles",l&&"All"!==l&&` (${g.length} publications)`]})]})};export{i as default};
